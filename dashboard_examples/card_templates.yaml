# Nature Remo ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ¼ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé›†
#
# ã“ã‚Œã‚‰ã®ã‚«ãƒ¼ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€è¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ã„ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã§ãã¾ã™ã€‚
# å„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£IDã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ä½¿ç”¨ã§ãã¾ã™ã€‚

# =============================================================================
# ç’°å¢ƒãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰ - æ¸©åº¦ãƒ»æ¹¿åº¦ãƒ»ç…§åº¦ã‚’ä¸€ã¤ã®ã‚«ãƒ¼ãƒ‰ã«ã¾ã¨ã‚ã¦è¡¨ç¤º
# =============================================================================
environment_monitor_card:
  type: vertical-stack
  cards:
    # ã‚¿ã‚¤ãƒˆãƒ«ã‚«ãƒ¼ãƒ‰
    - type: markdown
      content: |
        # ğŸ  ç’°å¢ƒãƒ¢ãƒ‹ã‚¿ãƒ¼
        {{ now().strftime('%Yå¹´%mæœˆ%dæ—¥ %H:%M') }}

    # ã‚»ãƒ³ã‚µãƒ¼å€¤ã®è¡¨ç¤º
    - type: glance
      entities:
        - entity: sensor.living_room_temperature
          name: æ¸©åº¦
        - entity: sensor.living_room_humidity
          name: æ¹¿åº¦
        - entity: sensor.living_room_illuminance
          name: ç…§åº¦
      show_state: true
      columns: 3

    # å¿«é©åº¦ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
    - type: entities
      entities:
        - type: custom:template-entity-row
          entity: sensor.living_room_temperature
          name: æ¸©åº¦çŠ¶æ…‹
          state: "{{ state_attr('sensor.living_room_temperature', 'comfort_level') }}"
          icon: "{{ state_attr('sensor.living_room_temperature', 'comfort_icon') }}"
        - type: custom:template-entity-row
          entity: sensor.living_room_humidity
          name: æ¹¿åº¦çŠ¶æ…‹
          state: "{{ state_attr('sensor.living_room_humidity', 'comfort_level') }}"
          secondary: "{{ state_attr('sensor.living_room_humidity', 'recommendation') }}"
          icon: "{{ state_attr('sensor.living_room_humidity', 'comfort_icon') }}"
        - type: custom:template-entity-row
          entity: sensor.living_room_illuminance
          name: æ˜ã‚‹ã•
          state: "{{ state_attr('sensor.living_room_illuminance', 'brightness_level') }}"
          icon: "{{ state_attr('sensor.living_room_illuminance', 'brightness_icon') }}"

# =============================================================================
# ã‚·ãƒ³ãƒ—ãƒ«ç’°å¢ƒã‚«ãƒ¼ãƒ‰ - ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ¼ãƒ‰ä¸è¦ã®ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆ
# =============================================================================
simple_environment_card:
  type: entities
  title: ç’°å¢ƒã‚»ãƒ³ã‚µãƒ¼
  show_header_toggle: false
  state_color: true
  entities:
    - entity: sensor.living_room_temperature
      name: å®¤æ¸©
      icon: mdi:thermometer
      secondary_info: last-changed
    - entity: sensor.living_room_humidity
      name: æ¹¿åº¦
      icon: mdi:water-percent
      secondary_info: last-changed
    - entity: sensor.living_room_illuminance
      name: ç…§åº¦
      icon: mdi:brightness-6
      secondary_info: last-changed

# =============================================================================
# ã‚¨ã‚¢ã‚³ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚«ãƒ¼ãƒ‰ - è©³ç´°ãªåˆ¶å¾¡ãŒå¯èƒ½
# =============================================================================
ac_control_card:
  type: vertical-stack
  cards:
    # ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ¢ã‚¹ã‚¿ãƒƒãƒˆ
    - type: thermostat
      entity: climate.living_room_ac
      name: ãƒªãƒ“ãƒ³ã‚°ã‚¨ã‚¢ã‚³ãƒ³
      features:
        - type: climate-hvac-modes
          hvac_modes:
            - 'off'
            - cool
            - heat
            - dry
            - fan_only
            - auto
        - type: climate-preset-modes
        - type: target-temperature

    # ã‚¯ã‚¤ãƒƒã‚¯è¨­å®šãƒœã‚¿ãƒ³
    - type: horizontal-stack
      cards:
        - type: button
          name: å†·æˆ¿ 24Â°C
          icon: mdi:snowflake
          tap_action:
            action: call-service
            service: climate.set_temperature
            service_data:
              entity_id: climate.living_room_ac
              temperature: 24
              hvac_mode: cool
          hold_action:
            action: none

        - type: button
          name: æš–æˆ¿ 22Â°C
          icon: mdi:fire
          tap_action:
            action: call-service
            service: climate.set_temperature
            service_data:
              entity_id: climate.living_room_ac
              temperature: 22
              hvac_mode: heat
          hold_action:
            action: none

        - type: button
          name: é™¤æ¹¿
          icon: mdi:water-minus
          tap_action:
            action: call-service
            service: climate.set_hvac_mode
            service_data:
              entity_id: climate.living_room_ac
              hvac_mode: dry
          hold_action:
            action: none

        - type: button
          name: åœæ­¢
          icon: mdi:power
          tap_action:
            action: call-service
            service: climate.turn_off
            target:
              entity_id: climate.living_room_ac
          hold_action:
            action: none

# =============================================================================
# é›»åŠ›ãƒ¢ãƒ‹ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰ - ã‚¹ãƒãƒ¼ãƒˆãƒ¡ãƒ¼ã‚¿ãƒ¼å¯¾å¿œ
# =============================================================================
power_monitor_card:
  type: vertical-stack
  cards:
    # ç¾åœ¨ã®æ¶ˆè²»é›»åŠ›(ã‚²ãƒ¼ã‚¸)
    - type: gauge
      entity: sensor.smart_meter_power
      name: æ¶ˆè²»é›»åŠ›
      min: 0
      max: 6000
      severity:
        green: 0
        yellow: 2000
        red: 4000
      needle: true
      unit: W

    # é›»åŠ›ä½¿ç”¨çŠ¶æ³
    - type: entities
      show_header_toggle: false
      entities:
        - type: custom:template-entity-row
          entity: sensor.smart_meter_power
          name: ä½¿ç”¨çŠ¶æ³
          state: "{{ state_attr('sensor.smart_meter_power', 'status') }}"
          secondary: "æ¨å®šæ—¥æ¬¡ã‚³ã‚¹ãƒˆ: Â¥{{ state_attr('sensor.smart_meter_power', 'estimated_daily_cost') }}"
          icon: "{{ state_attr('sensor.smart_meter_power', 'usage_icon') }}"

    # ç´¯ç©é›»åŠ›é‡
    - type: entity
      entity: sensor.smart_meter_energy
      name: ç´¯ç©é›»åŠ›é‡
      icon: mdi:counter

# =============================================================================
# ã‚·ãƒ³ãƒ—ãƒ«é›»åŠ›ã‚«ãƒ¼ãƒ‰ - ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ¼ãƒ‰ä¸è¦
# =============================================================================
simple_power_card:
  type: entities
  title: é›»åŠ›ãƒ¢ãƒ‹ã‚¿ãƒ¼
  show_header_toggle: false
  entities:
    - entity: sensor.smart_meter_power
      name: ç¾åœ¨ã®æ¶ˆè²»é›»åŠ›
      icon: mdi:flash
    - entity: sensor.smart_meter_energy
      name: ç´¯ç©é›»åŠ›é‡
      icon: mdi:counter

# =============================================================================
# çµ±åˆã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« - ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’1æšã«
# =============================================================================
unified_control_panel:
  type: vertical-stack
  cards:
    # ãƒ˜ãƒƒãƒ€ãƒ¼
    - type: markdown
      content: |
        # ğŸ›ï¸ Nature Remo ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        {{ now().strftime('%m/%d %H:%M') }}

    # ç’°å¢ƒã‚»ãƒ³ã‚µãƒ¼(ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤º)
    - type: glance
      title: ç’°å¢ƒ
      entities:
        - entity: sensor.living_room_temperature
          name: æ¸©åº¦
        - entity: sensor.living_room_humidity
          name: æ¹¿åº¦
        - entity: sensor.living_room_illuminance
          name: ç…§åº¦
      columns: 3

    # ã‚¨ã‚¢ã‚³ãƒ³åˆ¶å¾¡
    - type: tile
      entity: climate.living_room_ac
      name: ã‚¨ã‚¢ã‚³ãƒ³
      features:
        - type: climate-hvac-modes
        - type: target-temperature

    # ç…§æ˜åˆ¶å¾¡
    - type: horizontal-stack
      cards:
        - type: tile
          entity: light.living_room_light
          name: ãƒªãƒ“ãƒ³ã‚°
          features:
            - type: light-brightness

        - type: tile
          entity: light.bedroom_light
          name: å¯å®¤
          features:
            - type: light-brightness

    # ãã®ä»–ã®ãƒ‡ãƒã‚¤ã‚¹
    - type: glance
      title: ãã®ä»–
      entities:
        - entity: switch.tv
          name: TV
        - entity: switch.fan
          name: æ‰‡é¢¨æ©Ÿ
        - entity: remote.living_room_remote
          name: ãƒªãƒ¢ã‚³ãƒ³
      show_state: true

# =============================================================================
# ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆå‘ã‘ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
# =============================================================================
tablet_fullscreen_dashboard:
  type: panel
  cards:
    - type: vertical-stack
      cards:
        # æ™‚åˆ»ã¨ç’°å¢ƒæƒ…å ±
        - type: markdown
          content: |
            # {{ now().strftime('%H:%M') }}
            {{ now().strftime('%Yå¹´%mæœˆ%dæ—¥ (%a)') }}
          style: |
            ha-card {
              font-size: 2em;
              text-align: center;
              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
              color: white;
            }

        # ç’°å¢ƒã‚»ãƒ³ã‚µãƒ¼(å¤§ããè¡¨ç¤º)
        - type: horizontal-stack
          cards:
            - type: sensor
              entity: sensor.living_room_temperature
              name: æ¸©åº¦
              graph: line
              detail: 2
              style: |
                ha-card {
                  font-size: 1.5em;
                }

            - type: sensor
              entity: sensor.living_room_humidity
              name: æ¹¿åº¦
              graph: line
              detail: 2
              style: |
                ha-card {
                  font-size: 1.5em;
                }

        # ã‚¨ã‚¢ã‚³ãƒ³(å¤§ããè¡¨ç¤º)
        - type: thermostat
          entity: climate.living_room_ac
          name: ã‚¨ã‚¢ã‚³ãƒ³
          features:
            - type: climate-hvac-modes
            - type: target-temperature

        # ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³(å¤§ããªãƒœã‚¿ãƒ³)
        - type: grid
          columns: 2
          square: false
          cards:
            - type: button
              name: å†·æˆ¿é–‹å§‹
              icon: mdi:snowflake
              icon_height: 64px
              tap_action:
                action: call-service
                service: script.ac_cool_start
              style: |
                ha-card {
                  font-size: 1.5em;
                  height: 120px;
                }

            - type: button
              name: æš–æˆ¿é–‹å§‹
              icon: mdi:fire
              icon_height: 64px
              tap_action:
                action: call-service
                service: script.ac_heat_start
              style: |
                ha-card {
                  font-size: 1.5em;
                  height: 120px;
                }

            - type: button
              name: ç…§æ˜ON
              icon: mdi:lightbulb
              icon_height: 64px
              tap_action:
                action: call-service
                service: light.turn_on
                target:
                  entity_id: light.living_room_light
              style: |
                ha-card {
                  font-size: 1.5em;
                  height: 120px;
                }

            - type: button
              name: å…¨ã¦OFF
              icon: mdi:power
              icon_height: 64px
              tap_action:
                action: call-service
                service: script.all_off
              style: |
                ha-card {
                  font-size: 1.5em;
                  height: 120px;
                }

# =============================================================================
# ãƒŸãƒ‹ãƒãƒ«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚«ãƒ¼ãƒ‰ - çœã‚¹ãƒšãƒ¼ã‚¹è¡¨ç¤º
# =============================================================================
minimal_status_card:
  type: markdown
  content: |
    ## å®¤å†…ç’°å¢ƒ

    <table width="100%">
      <tr>
        <td align="center">
          <ha-icon icon="mdi:thermometer"></ha-icon><br>
          <b>{{ states('sensor.living_room_temperature') }}Â°C</b><br>
          <small>{{ state_attr('sensor.living_room_temperature', 'comfort_level') }}</small>
        </td>
        <td align="center">
          <ha-icon icon="mdi:water-percent"></ha-icon><br>
          <b>{{ states('sensor.living_room_humidity') }}%</b><br>
          <small>{{ state_attr('sensor.living_room_humidity', 'comfort_level') }}</small>
        </td>
        <td align="center">
          <ha-icon icon="mdi:brightness-6"></ha-icon><br>
          <b>{{ states('sensor.living_room_illuminance') }} lx</b><br>
          <small>{{ state_attr('sensor.living_room_illuminance', 'brightness_level') }}</small>
        </td>
      </tr>
    </table>

    ---

    ### ã‚¨ã‚¢ã‚³ãƒ³: {{ states('climate.living_room_ac') }}
    {% if is_state('climate.living_room_ac', 'cool') or is_state('climate.living_room_ac', 'heat') %}
    è¨­å®šæ¸©åº¦: {{ state_attr('climate.living_room_ac', 'temperature') }}Â°C
    {% endif %}

    {% if states('sensor.smart_meter_power') != 'unavailable' %}
    ---

    ### é›»åŠ›: {{ states('sensor.smart_meter_power') }} W
    {{ state_attr('sensor.smart_meter_power', 'status') }}
    {% endif %}
  style: |
    ha-card {
      font-size: 1.2em;
    }

# =============================================================================
# ä½¿ç”¨æ–¹æ³•
# =============================================================================
#
# 1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚‹
# 2. ã‚«ãƒ¼ãƒ‰ã‚’è¿½åŠ 
# 3. æ‰‹å‹•ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠ
# 4. ä¸Šè¨˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆ
# 5. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£IDã‚’è‡ªåˆ†ã®ç’°å¢ƒã«åˆã‚ã›ã¦å¤‰æ›´
# 6. ä¿å­˜
#
# ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ¼ãƒ‰ãŒå¿…è¦ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:
# - environment_monitor_card (template-entity-row ãŒå¿…è¦)
# - power_monitor_card (template-entity-row ãŒå¿…è¦)
#
# ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ¼ãƒ‰ä¸è¦ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:
# - simple_environment_card
# - ac_control_card
# - simple_power_card
# - unified_control_panel
# - tablet_fullscreen_dashboard
# - minimal_status_card
